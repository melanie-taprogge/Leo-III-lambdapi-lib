require open Leo-III-lambdapi-lib.MetaTheorems;
require open Stdlib.PropExt;

/* 
Library on versions of the natural deduction rules over more than just two terms
*/

////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////// â‡’ //////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////


symbol multi_impl : ğ•ƒ o â†’ Ï„ o â†’ Prop;
rule multi_impl ($p0 â¸¬ $p) $p1 â†ª $p0 â‡’ (multi_impl $p $p1)
with multi_impl â–¡ $p0 â†ª $p0;

symbol multi_impl_correct (p : ğ•ƒ o) (p0 p1: Prop): Ï€ ((multi_impl (p0 â¸¬ p) p1) = (p0 â‡’ multi_impl p p1)) â‰”
begin
    induction
        {simplify; assume x0 x1; reflexivity}
        {simplify; assume p0 p h0 p1 p2;
        rewrite h0 p0; reflexivity}
end;


////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////// âˆ¨ //////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

symbol âˆ¨áµ¢â‚™â‚‚ (c0 : ğ•ƒ o) (c1 : ğ•ƒ o) : Ï€ (disj c1) â†’ Ï€ (disj (c0 ++ c1))â‰”
begin
    induction
        {assume x h;
        refine h}
        {assume x0 l0 h0 l1 h1; simplify;
        rewrite disj_correct;
        refine âˆ¨áµ¢â‚‚ (h0 l1 h1)}
end;

symbol âˆ¨áµ¢â‚™â‚ (c0 : ğ•ƒ o) (c1 : ğ•ƒ o) : Ï€ (disj c0) â†’ Ï€ (disj (c0 ++ c1))â‰”
begin
    induction
        {assume x h; refine âŠ¥â‚‘ h}
        {assume x0 l h0 x1; 
        type h0 x1;
        rewrite disj_correct; assume h1; 
        simplify; 
        rewrite disj_correct;
        refine âˆ¨â‚‘ h1 _ _
            {assume h2;
            refine âˆ¨áµ¢â‚ h2}
            {assume h2;
            refine âˆ¨áµ¢â‚‚ (h0 x1 h2)}}
end;

