require open Stdlib.Set Stdlib.Prop Stdlib.PropExt Stdlib.List;

/******************************************************************************
 *  Setup for the user defined tactic         
 ******************************************************************************/

 constant symbol Tactic : TYPE;
 symbol tactic : Set;
 rule Ï„ tactic â†ª Tactic;
 
 symbol #rewrite : Î  [a], Ï€ a â†’ Ï„ tactic;
 builtin "rewrite" â‰” #rewrite;

 symbol #rewrite_left [a] : Ï€ a â†’ Tactic;
 builtin "rewrite left" â‰” #rewrite_left;
 
 constant symbol String : TYPE;
 builtin "String" â‰” String;
 
 symbol #orelse : Tactic â†’ Tactic â†’ Tactic;
 builtin "orelse" â‰” #orelse;
 notation #orelse infix left 10000;
 
 symbol #refine : Î  [a], Ï€ a â†’ Tactic;
 builtin "refine" â‰” #refine;
 
 symbol #repeat : Tactic â†’ Tactic;
 builtin "repeat" â‰” #repeat;
 
 symbol #fail : Tactic;
 builtin "fail" â‰” #fail;
 
 symbol #admit : Tactic;
 builtin "admit" â‰” #admit;
 
 symbol #and : Tactic â†’ Tactic â†’ Tactic;
 builtin "and" â‰” #and;
 
 symbol #apply : Î  [a], Ï€ a â†’ Tactic;
 builtin "apply" â‰” #apply;
 
 symbol #assume : String â†’ Tactic;
 builtin "assume" â‰” #assume;
 
 symbol #generalize : Î  [a], Ï€ a â†’ Tactic;
 builtin "generalize" â‰” #generalize;
 
 symbol #have : String â†’ Î  [a], Ï€ a â†’ Tactic;
 builtin "have" â‰” #have; 
 
 symbol #induction : Tactic;
 builtin "induction" â‰” #induction; 
 
 symbol #remove : Î  [a], Ï€ a â†’ Tactic;
 builtin "remove" â‰” #remove;
 
 symbol #reflexivity : Tactic;
 builtin "reflexivity" â‰” #reflexivity;
 
 symbol #set : String â†’ Î  [a], Ï€ a â†’ Tactic;
 builtin "set" â‰” #set;
 
 symbol #simplify : Tactic;
 builtin "simplify" â‰” #simplify;

 symbol #simplify_beta : Tactic;
 builtin "simplify rule off" â‰” #simplify_beta;
 
 symbol #solve : Tactic;
 builtin "solve" â‰” #solve;
 
 symbol #symmetry : Tactic;
 builtin "symmetry" â‰” #symmetry;
 
 symbol #try : Tactic;
 builtin "try" â‰” #try;
 
 symbol #why3 : Tactic;
 builtin "why3" â‰” #why3; 

 
 // necessary in order to define the tactics
 protected symbol set0 : Set;
 rule Ï„ set0 â†ª Set;
 
 
/******************************************************************************
*  Definition of Leo-III simplification tactic        
******************************************************************************/
 
 symbol applyAny : ğ•ƒ tactic â†’ Tactic;
 rule applyAny ($t0 â¸¬ $tl) â†ª $t0 #orelse (applyAny $tl)
 with applyAny â–¡ â†ª #fail;
 
 symbol listOfAllSimpRules â‰” ((#rewrite âˆ¨_idem) â¸¬ (#rewrite em_eq_l) â¸¬ (#rewrite em_eq_r) â¸¬ (#rewrite âˆ¨âŠ¤) â¸¬ 
     (#rewrite âŠ¤âˆ¨) â¸¬ (#rewrite âˆ¨âŠ¥) â¸¬ (#rewrite âŠ¥âˆ¨) â¸¬ (#rewrite âˆ§_idem) â¸¬ (#rewrite âˆ§_contra_r) â¸¬ (#rewrite âˆ§_contra_l) â¸¬ 
     (#rewrite âˆ§âŠ¤) â¸¬ (#rewrite âŠ¤âˆ§) â¸¬ (#rewrite âˆ§âŠ¥) â¸¬ (#rewrite âŠ¥âˆ§) â¸¬ (#rewrite â‡’âŠ¤) â¸¬ (#rewrite âŠ¥â‡’) â¸¬ (#rewrite âŠ¤â‡’) â¸¬ 
     (#rewrite â‡’âŠ¥) â¸¬ (#rewrite â‡’_idem) â¸¬ (#rewrite â‡”âŠ¤) â¸¬ (#rewrite âŠ¤â‡”) â¸¬ (#rewrite âŠ¥â‡”) â¸¬ (#rewrite â‡”âŠ¥) â¸¬ 
     (#rewrite â‡”_idem) â¸¬ (#rewrite Â¬âŠ¤) â¸¬ (#rewrite Â¬âŠ¥) â¸¬ (#rewrite Â¬Â¬â‚‘_eq) â¸¬ (#rewrite =âŠ¤) â¸¬ (#rewrite âŠ¤=) â¸¬ 
     (#rewrite =âŠ¥) â¸¬ (#rewrite âŠ¥=) â¸¬ (#rewrite =_idem) â¸¬ (#rewrite Â¬=âŠ¥) â¸¬ (#rewrite Â¬âŠ¥=) â¸¬ (#rewrite Â¬=âŠ¤) â¸¬ 
     (#rewrite Â¬âŠ¤=) â¸¬ (#rewrite Â¬=_idem) â¸¬ (#rewrite âˆ€_const) â¸¬ (#rewrite âˆƒ_const) â¸¬ (#rewrite polarity_switch) â¸¬ (#refine âŠ¤áµ¢) â¸¬ â–¡);
 
 symbol applyAllSimplifications â‰” #repeat (applyAny listOfAllSimpRules);


/******************************************************************************
*  Definition of Leo-III clausification tactic        
******************************************************************************/

symbol normAsso â‰” #repeat ((#rewrite âˆ§_assoc) #orelse (#rewrite âˆ¨_assoc));

symbol allCNFids_list â‰” ((#rewrite deMorgan_âˆ§) â¸¬ (#rewrite deMorgan_âˆ¨) â¸¬ (#rewrite â‡’=âˆ¨) â¸¬ (#rewrite Â¬â‡’=âˆ§Â¬) â¸¬ (#and (#rewrite âˆ§âˆ¨_dist_l) normAsso) â¸¬ (#and (#rewrite âˆ§âˆ¨_dist_r) normAsso) â¸¬ (#rewrite Â¬Â¬â‚‘_eq) â¸¬ â–¡);

symbol allCNFids_app â‰” #and (#and (#repeat (applyAny allCNFids_list)) normAsso) #reflexivity;